(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[89823],{32130:function(e,t,i){var r={"./prism-abap.min":[52093,52093],"./prism-abnf.min":[84270,84270],"./prism-actionscript.min":[87705,87705],"./prism-ada.min":[77808,77808],"./prism-agda.min":[36473,36473],"./prism-al.min":[70637,70637],"./prism-antlr4.min":[86671,86671],"./prism-apacheconf.min":[66228,66228],"./prism-apex.min":[14026,14026],"./prism-apl.min":[32042,32042],"./prism-applescript.min":[95642,95642],"./prism-aql.min":[58892,58892],"./prism-arduino.min":[58819,58819],"./prism-arff.min":[68665,68665],"./prism-armasm.min":[82564,82564],"./prism-arturo.min":[8639,8639],"./prism-asciidoc.min":[67395,67395],"./prism-asm6502.min":[76274,76274],"./prism-asmatmel.min":[63424,63424],"./prism-aspnet.min":[16881,16881],"./prism-autohotkey.min":[4792,4792],"./prism-autoit.min":[95007,95007],"./prism-avisynth.min":[50138,50138],"./prism-avro-idl.min":[70927,70927],"./prism-awk.min":[49111,49111],"./prism-bash.min":[7970,7970],"./prism-basic.min":[25726,25726],"./prism-batch.min":[62217,62217],"./prism-bbcode.min":[86559,86559],"./prism-bbj.min":[77321,77321],"./prism-bicep.min":[3822,3822],"./prism-birb.min":[51650,51650],"./prism-bison.min":[6759,6759],"./prism-bnf.min":[80804,80804],"./prism-bqn.min":[25493,25493],"./prism-brainfuck.min":[31830,31830],"./prism-brightscript.min":[4911,4911],"./prism-bro.min":[66676,66676],"./prism-bsl.min":[42493,42493],"./prism-c.min":[79484,79484],"./prism-cfscript.min":[30996,30996],"./prism-chaiscript.min":[90134,90134],"./prism-cil.min":[66378,66378],"./prism-cilkc.min":[96161,96161],"./prism-cilkcpp.min":[60359,60359],"./prism-clike.min":[76914,76914],"./prism-clojure.min":[84515,84515],"./prism-cmake.min":[71316,71316],"./prism-cobol.min":[86226,86226],"./prism-coffeescript.min":[87203,87203],"./prism-concurnas.min":[32670,32670],"./prism-cooklang.min":[74289,74289],"./prism-coq.min":[53600,53600],"./prism-core.min":[1234,1234],"./prism-cpp.min":[70465,70465],"./prism-crystal.min":[45762,45762],"./prism-csharp.min":[43519,43519],"./prism-cshtml.min":[27055,27055],"./prism-csp.min":[50412,50412],"./prism-css-extras.min":[16701,16701],"./prism-css.min":[72677,72677],"./prism-csv.min":[11788,11788],"./prism-cue.min":[13961,13961],"./prism-cypher.min":[95950,95950],"./prism-d.min":[13746,13746],"./prism-dart.min":[71892,71892],"./prism-dataweave.min":[1609,1609],"./prism-dax.min":[40413,40413],"./prism-dhall.min":[99149,99149],"./prism-diff.min":[96913,96913],"./prism-django.min":[65182,65182],"./prism-dns-zone-file.min":[74013,74013],"./prism-docker.min":[24934,24934],"./prism-dot.min":[10489,10489],"./prism-ebnf.min":[314,314],"./prism-editorconfig.min":[56250,56250],"./prism-eiffel.min":[14299,14299],"./prism-ejs.min":[16345,16345],"./prism-elixir.min":[98847,98847],"./prism-elm.min":[87740,87740],"./prism-erb.min":[98266,3229],"./prism-erlang.min":[69812,69812],"./prism-etlua.min":[27784,27784],"./prism-excel-formula.min":[65809,65809],"./prism-factor.min":[76868,76868],"./prism-false.min":[61424,61424],"./prism-firestore-security-rules.min":[77525,77525],"./prism-flow.min":[76833,76833],"./prism-fortran.min":[77773,77773],"./prism-fsharp.min":[92855,92855],"./prism-ftl.min":[12873,12873],"./prism-gap.min":[60602,60602],"./prism-gcode.min":[93577,93577],"./prism-gdscript.min":[21690,21690],"./prism-gedcom.min":[18978,18978],"./prism-gettext.min":[60646,60646],"./prism-gherkin.min":[63303,63303],"./prism-git.min":[22301,22301],"./prism-glsl.min":[65738,8477],"./prism-gml.min":[93503,93503],"./prism-gn.min":[81111,81111],"./prism-go-module.min":[65117,65117],"./prism-go.min":[53967,53967],"./prism-gradle.min":[67217,67217],"./prism-graphql.min":[28751,28751],"./prism-groovy.min":[64613,64613],"./prism-haml.min":[39219,39219],"./prism-handlebars.min":[46888,46888],"./prism-haskell.min":[55463,55463],"./prism-haxe.min":[33515,33515],"./prism-hcl.min":[97900,97900],"./prism-hlsl.min":[76155,76155],"./prism-hoon.min":[88975,88975],"./prism-hpkp.min":[81866,81866],"./prism-hsts.min":[87579,87579],"./prism-http.min":[47959,47959],"./prism-ichigojam.min":[49363,49363],"./prism-icon.min":[16911,16911],"./prism-icu-message-format.min":[26429,26429],"./prism-idris.min":[96894,96894],"./prism-iecst.min":[23080,23080],"./prism-ignore.min":[82510,82510],"./prism-inform7.min":[37187,37187],"./prism-ini.min":[53957,53957],"./prism-io.min":[75188,75188],"./prism-j.min":[3063,3063],"./prism-java.min":[15624,15624],"./prism-javadoc.min":[98071,98071],"./prism-javadoclike.min":[60197,60197],"./prism-javascript.min":[26393,26393],"./prism-javastacktrace.min":[15419,15419],"./prism-jexl.min":[63658,63658],"./prism-jolie.min":[94314,94314],"./prism-jq.min":[19357,19357],"./prism-js-extras.min":[79141,79141],"./prism-js-templates.min":[23630,23630],"./prism-jsdoc.min":[54649,54649],"./prism-json.min":[49497,49497],"./prism-json5.min":[1149,1149],"./prism-jsonp.min":[98444,98444],"./prism-jsstacktrace.min":[37292,37292],"./prism-jsx.min":[43771,43771],"./prism-julia.min":[78737,78737],"./prism-keepalived.min":[43592,43592],"./prism-keyman.min":[15816,15816],"./prism-kotlin.min":[57289,57289],"./prism-kumir.min":[76936,76936],"./prism-kusto.min":[6267,6267],"./prism-latex.min":[88096,88096],"./prism-latte.min":[49205,49205],"./prism-less.min":[97514,97514],"./prism-lilypond.min":[88995,88995],"./prism-linker-script.min":[36534,36534],"./prism-liquid.min":[72745,72745],"./prism-lisp.min":[3630,3630],"./prism-livescript.min":[45942,45942],"./prism-llvm.min":[34855,34855],"./prism-log.min":[17602,17602],"./prism-lolcode.min":[32022,32022],"./prism-lua.min":[65899,65899],"./prism-magma.min":[26398,26398],"./prism-makefile.min":[60040,60040],"./prism-markdown.min":[57406,57406],"./prism-markup-templating.min":[26913,26913],"./prism-markup.min":[87480,87480],"./prism-mata.min":[14020,14020],"./prism-matlab.min":[61952,61952],"./prism-maxscript.min":[24721,24721],"./prism-mel.min":[26288,26288],"./prism-mermaid.min":[3359,3359],"./prism-metafont.min":[49352,49352],"./prism-mizar.min":[69046,69046],"./prism-mongodb.min":[97015,97015],"./prism-monkey.min":[9057,9057],"./prism-moonscript.min":[53094,53094],"./prism-n1ql.min":[126,126],"./prism-n4js.min":[88190,88190],"./prism-nand2tetris-hdl.min":[82806,82806],"./prism-naniscript.min":[92612,92612],"./prism-nasm.min":[77588,77588],"./prism-neon.min":[97653,97653],"./prism-nevod.min":[87234,87234],"./prism-nginx.min":[44982,44982],"./prism-nim.min":[86510,86510],"./prism-nix.min":[13144,13144],"./prism-nsis.min":[96563,96563],"./prism-objectivec.min":[49336,49336],"./prism-ocaml.min":[52937,52937],"./prism-odin.min":[67553,67553],"./prism-opencl.min":[12198,12198],"./prism-openqasm.min":[13571,13571],"./prism-oz.min":[98459,98459],"./prism-parigp.min":[82749,82749],"./prism-parser.min":[34946,34946],"./prism-pascal.min":[91832,91832],"./prism-pascaligo.min":[45263,45263],"./prism-pcaxis.min":[63192,63192],"./prism-peoplecode.min":[60114,60114],"./prism-perl.min":[4280,4280],"./prism-php-extras.min":[90964,90964],"./prism-php.min":[69720,69720],"./prism-phpdoc.min":[36735,36735],"./prism-plant-uml.min":[65364,65364],"./prism-plsql.min":[39173,39173],"./prism-powerquery.min":[34397,34397],"./prism-powershell.min":[79285,79285],"./prism-processing.min":[50704,50704],"./prism-prolog.min":[10134,10134],"./prism-promql.min":[3838,3838],"./prism-properties.min":[12820,12820],"./prism-protobuf.min":[2770,2770],"./prism-psl.min":[72430,72430],"./prism-pug.min":[73738,73738],"./prism-puppet.min":[1351,1351],"./prism-pure.min":[49455,49455],"./prism-purebasic.min":[2077,2077],"./prism-purescript.min":[48169,48169],"./prism-python.min":[39659,39659],"./prism-q.min":[57944,57944],"./prism-qml.min":[17151,17151],"./prism-qore.min":[33201,33201],"./prism-qsharp.min":[28475,28475],"./prism-r.min":[10139,10139],"./prism-racket.min":[57180,57180],"./prism-reason.min":[70391,70391],"./prism-regex.min":[66367,66367],"./prism-rego.min":[14224,14224],"./prism-renpy.min":[96973,96973],"./prism-rescript.min":[15193,15193],"./prism-rest.min":[30040,30040],"./prism-rip.min":[45997,45997],"./prism-roboconf.min":[53958,53958],"./prism-robotframework.min":[91682,91682],"./prism-ruby.min":[30143,30143],"./prism-rust.min":[82380,82380],"./prism-sas.min":[69528,69528],"./prism-sass.min":[89426,89426],"./prism-scala.min":[89530,89530],"./prism-scheme.min":[29361,29361],"./prism-scss.min":[75881,75881],"./prism-shell-session.min":[43935,43935],"./prism-smali.min":[48063,48063],"./prism-smalltalk.min":[52668,52668],"./prism-smarty.min":[9835,9835],"./prism-sml.min":[8682,8682],"./prism-solidity.min":[57843,57843],"./prism-solution-file.min":[73761,73761],"./prism-soy.min":[37495,37495],"./prism-sparql.min":[37167,37167],"./prism-splunk-spl.min":[84331,84331],"./prism-sqf.min":[54463,54463],"./prism-sql.min":[47046,47046],"./prism-squirrel.min":[53742,53742],"./prism-stan.min":[84153,84153],"./prism-stata.min":[68289,68289],"./prism-stylus.min":[61304,61304],"./prism-supercollider.min":[13197,13197],"./prism-swift.min":[2760,2760],"./prism-systemd.min":[829,829],"./prism-t4-cs.min":[84728,84728],"./prism-t4-templating.min":[4008,4008],"./prism-t4-vb.min":[38286,38286],"./prism-tap.min":[18283,18283],"./prism-tcl.min":[87143,87143],"./prism-textile.min":[32222,32222],"./prism-toml.min":[75169,75169],"./prism-tremor.min":[49287,49287],"./prism-tsx.min":[84791,84791],"./prism-tt2.min":[26983,26983],"./prism-turtle.min":[39562,39562],"./prism-twig.min":[83411,83411],"./prism-typescript.min":[3142,3142],"./prism-typoscript.min":[85254,85254],"./prism-unrealscript.min":[54579,54579],"./prism-uorazor.min":[62447,62447],"./prism-uri.min":[70484,70484],"./prism-v.min":[92238,92238],"./prism-vala.min":[7109,7109],"./prism-vbnet.min":[99471,99471],"./prism-velocity.min":[17755,17755],"./prism-verilog.min":[16723,16723],"./prism-vhdl.min":[1497,1497],"./prism-vim.min":[71927,71927],"./prism-visual-basic.min":[87886,87886],"./prism-warpscript.min":[20451,20451],"./prism-wasm.min":[70830,70830],"./prism-web-idl.min":[54044,54044],"./prism-wgsl.min":[24657,24657],"./prism-wiki.min":[41279,41279],"./prism-wolfram.min":[55824,55824],"./prism-wren.min":[20008,20008],"./prism-xeora.min":[24384,24384],"./prism-xml-doc.min":[73953,73953],"./prism-xojo.min":[25893,25893],"./prism-xquery.min":[7497,7497],"./prism-yaml.min":[46535,46535],"./prism-yang.min":[9015,9015],"./prism-zig.min":[63492,63492]};function webpackAsyncContext(e){if(!i.o(r,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],n=t[0];return i.e(t[1]).then(function(){return i.t(n,23)})}webpackAsyncContext.keys=function(){return Object.keys(r)},webpackAsyncContext.id=32130,e.exports=webpackAsyncContext},79068:function(e,t,i){"use strict";var r=i(97458),n=i(14517),s=i(52983),m=i(59147),o=i(74223);t.Z=e=>{let{type:t,mode:i,content:a,networkBusy:l,onSubmit:d}=e,c=(0,m.Z)(),p=(0,s.useRef)(null),[u,h]=(0,s.useState)(a||""),[g,x]=(0,s.useState)(!1),handleCommentSubmit=async e=>{if(e.preventDefault(),"yes"!==c){(0,o.ho)({isDismissable:!0});return}try{x(!0);let e=await d(u);if("success"===e){h("");let e=document.getElementById("comment-input-box");e&&(e.style.height="2.375ch")}}catch(e){console.error(e)}finally{x(!1)}};return(0,r.jsxs)("form",{ref:p,className:(0,n.default)("z-50 flex flex-col pb-6 pt-2","light"===i?"bg-transparent":"bg-gray-900"),onSubmit:handleCommentSubmit,children:[(0,r.jsxs)("span",{className:(0,n.default)("mb-2 block text-right text-xs",u.length>2e4?"text-red-600":u.length>15e3?"text-yellow-400":"text-gray-400"),children:[u.length,"/",2e4]}),(0,r.jsxs)("div",{className:(0,n.default)("shadow-xs relative flex w-full flex-grow flex-col rounded-xl border md:pl-4 ring-primary-600","light"===i?"border-gray-300 bg-gray-50":"border-gray-900/50 bg-gray-800 text-white","reply"===t?"focus-within:ring-1 py-3 text-sm":"focus-within:ring-2 py-[10px] md:py-4"),children:[(0,r.jsx)("textarea",{minLength:1,rows:1,name:"comment-input-box",id:"comment-input-box",value:u,onKeyDown:e=>{if((13===e.keyCode||"Enter"===e.key)&&!e.shiftKey){var t;e.preventDefault(),null===(t=p.current)||void 0===t||t.requestSubmit()}},autoFocus:"reply"===t,onChange:e=>{h(e.target.value);let t=e.currentTarget;"comment-input-box"===t.id&&(t.style.height="1px",t.style.height="".concat(t.scrollHeight,"px"))},className:(0,n.default)("m-0 max-h-[200px] w-full resize-none border-0 bg-transparent p-0 pl-3 pr-10 focus:ring-0 focus-visible:ring-0 dark:bg-transparent md:pl-0 md:pr-12","reply"===t?"text-sm":""),placeholder:"Add your ".concat(t)}),(0,r.jsx)("button",{type:"submit",disabled:""===u.trim()||g||l,className:(0,n.default)("absolute bottom-1.5 right-2 rounded-md p-1 text-white transition-colors enabled:bg-indigo-600 disabled:text-gray-400 disabled:opacity-40 dark:hover:bg-gray-900 dark:disabled:hover:bg-transparent md:right-3 md:p-2","reply"===t?"md:bottom-2":"md:bottom-3"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"none",className:"m-1 h-4 w-4 md:m-0","stroke-width":"2",children:(0,r.jsx)("path",{d:"M.5 1.163A1 1 0 0 1 1.97.28l12.868 6.837a1 1 0 0 1 0 1.766L1.969 15.72A1 1 0 0 1 .5 14.836V10.33a1 1 0 0 1 .816-.983L8.5 8 1.316 6.653A1 1 0 0 1 .5 5.67V1.163Z",fill:"currentColor"})})})]})]})}},58958:function(e,t,i){"use strict";var r=i(97458),n=i(19639),s=i.n(n),m=i(52983),o=i(26667),a=i(73236),l=i(51720),d=i(23474),c=i(24600),p=i(59147),u=i(74223),h=i(61918),g=i(79068),x=i(14517),f=i(42327),v=i(61489),b=i(41332),y=i(63079),w=i(79018);let SingleComment=e=>{let{mode:t,shouldShowCourseData:i,courseItemPracticeProblemEtcSlug:n,comment:j,context:C}=e,{uniqueId:N,authorUser:k,repliesLength:I,content:M,updatedAt:S,upvotesCount:_,downvotesCount:E,loggedInUserAction:D,status:F}=j,T=F===d.rph.Deleted,A=(0,y.Z)(e=>e.deleteComment),P=(0,y.Z)(e=>e.addMoreCommentReplies),R=(0,y.Z)(e=>e.activelyReplyingCommentId),Z=(0,y.Z)(e=>e.writeProperty),U=(0,y.Z)(e=>e.storeMyVote),q=(0,y.Z)(e=>e._internalCommentSelfVoteMapping[N]),V=(0,y.Z)(e=>e.getCommentReplies({parentCommentUniqueId:N})),O="dark"===t,z=(0,p.Z)(),[H,B]=(0,m.useState)(M),[L,W]=(0,m.useState)(!1),[K,Y]=(0,m.useState)(null),[X,Q]=(0,m.useState)(!1),[G,{loading:J}]=(0,d.vMq)(),[$,{loading:ee}]=(0,d.sHn)(),[et,{loading:ei}]=(0,d.soE)(),[er,{called:en,loading:es}]=(0,d.Cm1)({onCompleted:e=>{let{getForumItemComments:t}=e;P({parentCommentId:N,comments:t.comments}),t.remaining>0?W(!0):W(!1)}});(0,d.TtD)({notifyOnNetworkStatusChange:!0,skip:"yes"!==z,onCompleted:e=>{let{userData:t}=e;Y(t)}});let addVote=async e=>{if(J)return;let t=null==K?void 0:K._id;if(!t){(0,u.ho)({isDismissable:!0});return}if(K.username===k.username){(0,h.a1)("You cannot ".concat(e.toLowerCase()," on your own comment!"));return}let{data:i}=await G({variables:{intent:e,commentId:N}});if(i&&i.addVote){let t=i.addVote;switch(t){case"404":(0,h.A)("Failed to ".concat(e));break;case"DOWNVOTE-UPVOTE":case"UPVOTE":U({commentId:N,voteType:d.M2R.Upvote});break;case"DOWNVOTE-DOWNVOTE":case"UPVOTE-UPVOTE":U({commentId:N,voteType:"removed"});break;case"DOWNVOTE":case"UPVOTE-DOWNVOTE":U({commentId:N,voteType:d.M2R.Downvote});break;default:(0,h.A)("Invalid vote state. Please contact support.")}}},deleteComment=async()=>{let e=await (0,b.S)({title:"Delete Comment",message:"Are you sure you want to delete this comment?",shouldRenderInDarkMode:O});if("yes"!==e)return;let{data:t}=await et({variables:{commentId:N}});(null==t?void 0:t.deleteComment.status)==="ok"?"DELETED"===t.deleteComment.data?A({courseItemPracticeProblemEtcSlug:n,commentId:N,context:C}):B("This content was deleted by the author"):(0,h.A)((null==t?void 0:t.deleteComment.error)||"Failed to delete comment")},createReply=async e=>{let{data:t}=await $({variables:{content:e,context:C,courseItemPracticeProblemEtcSlug:n,parentCommentId:N}});if((null==t?void 0:t.createComment.status)!=="ok")return(0,h.A)((null==t?void 0:t.createComment.error)||"Failed to add your reply."),"failed";{Z({activelyReplyingCommentId:null});let e=t.createComment.data;return e&&P({parentCommentId:N,comments:[e],shouldAppendAtStarting:!0}),"success"}},em=Math.max(I,V.length),eo=q===d.M2R.Upvote||null==q&&D===d.M2R.Upvote?o.L7p:o.DZs,ea=q===d.M2R.Downvote||null==q&&D===d.M2R.Downvote?o.Ov5:o.qBr,el=K&&!T&&((0,f.H1)({creatorId:k.uniqueId,userId:K._id,email:K.email})||K._id===k.uniqueId),ed=_,ec=E;"removed"===q?null==D||(D===d.M2R.Upvote?ed--:ec--):q===D||null!=q&&q!==D&&(null==D?q===d.M2R.Upvote?ed++:ec++:D===d.M2R.Upvote?(ed--,ec++):(ed++,ec--));let ep=(0,r.jsxs)("article",{className:(0,x.default)("relative flex flex-col gap-3 rounded p-2 transition-all duration-100",ei?"pointer-events-none opacity-50":""),children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(c.Z,{className:(0,x.default)("h-12 w-12 rounded-full","dark"===t?"bg-gray-800":"bg-gray-100"),src:k.profilePicUrl,alt:k.name.substring(0,2).toUpperCase(),height:40,width:40})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)(s(),{prefetch:!1,href:"/user/".concat(k.username),target:"_blank",className:(0,x.default)("text-[13px] font-bold",O?"text-gray-100":"text-gray-900"),children:k.name}),(0,r.jsx)("span",{className:"ml-2 cursor-default text-xs font-medium text-gray-500",children:(0,l.ZP)(S).fromNow()})]}),(0,r.jsx)("div",{className:(0,x.default)("mt-1 text-sm",O&&"dark",T&&"italic"),children:(0,r.jsx)(v.Z,{markdown:H,disallowHeadings:!0})}),(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:(0,x.default)("flex items-center space-x-4",O?"text-gray-100":"text-gray-900"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(eo,{onClick:()=>{addVote(d.Fyp.Upvote).catch(e=>console.error(e))},className:(0,x.default)("h-4 w-4 cursor-pointer text-xl md:h-5 md:w-5",J?"cursor-progress text-gray-400 opacity-70":"")}),J?null:(0,r.jsx)("span",{className:(0,x.default)("cursor-default text-xs opacity-70 hover:opacity-100",0===ed?"hidden":"block"),children:ed})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(ea,{onClick:()=>{addVote(d.Fyp.Downvote).catch(e=>console.error(e))},className:(0,x.default)("h-4 w-4 translate-y-0.5 -scale-x-100 cursor-pointer text-xl md:h-5 md:w-5",J?"cursor-progress text-gray-400 opacity-70":"")}),J?null:(0,r.jsx)("span",{className:(0,x.default)("cursor-default text-xs opacity-70 hover:opacity-100",0===ec?"hidden":"block"),children:ec})]})]}),(0,r.jsx)("button",{type:"button","data-testid":"reply-btn",className:(0,x.default)("rounded-full px-3 py-1 text-xs font-semibold",O?"text-gray-100 hover:bg-gray-800":"font-medium text-gray-600 hover:bg-gray-200"),onClick:()=>Z({activelyReplyingCommentId:N}),children:"Reply"}),el?(0,r.jsx)("button",{type:"button","data-testid":"delete-comment",disabled:ei,className:(0,x.default)("text-xs font-medium disabled:cursor-progress disabled:text-gray-400",O?"text-red-300":"text-red-500"),onClick:()=>{deleteComment().catch(e=>console.error(e))},children:"Delete"}):null]})]})]}),R===N?(0,r.jsx)("div",{className:"md:ml-10 lg:ml-16",children:(0,r.jsx)(g.Z,{type:"reply",networkBusy:ee,mode:t,onSubmit:createReply,onCancel:()=>{Z({activelyReplyingCommentId:null})}})}):null,(0,r.jsxs)("button",{className:(0,x.default)(O?"text-indigo-400":"text-indigo-600",R===N?"-mt-5":"",em<=0?"hidden":"z-10 ml-11 flex w-fit items-center text-xs font-semibold uppercase"),onClick:()=>{en||er({variables:{offset:0,limit:10,context:C,forceCommentOrder:"asc",courseItemPracticeProblemEtcSlug:n,parentCommentId:N}}).catch(e=>console.error(e)),Q(e=>!e)},children:[(0,r.jsx)(a.OrA,{className:(0,x.default)("-mt-0.5 mr-0.5 h-5 w-5",X?"rotate-180":"")}),(0,r.jsxs)("span",{children:[em," ",1===em?"Reply":"Replies"," "]})]}),es?(0,r.jsx)("div",{className:(0,x.default)("animate-pulse rounded px-3 py-4 pl-12",O?"bg-gray-800":"bg-gray-200"),children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:(0,x.default)("h-10 w-10 rounded-full",O?"bg-gray-700":"bg-gray-50")}),(0,r.jsxs)("div",{className:"flex w-full flex-col items-stretch gap-2 py-1",children:[(0,r.jsx)("div",{className:(0,x.default)("w-52 rounded p-1",O?"bg-gray-700":"bg-gray-50")}),(0,r.jsx)("div",{className:(0,x.default)("w-3/4 rounded p-1",O?"bg-gray-700":"bg-gray-50")}),(0,r.jsx)("div",{className:(0,x.default)("w-36 rounded p-1",O?"bg-gray-700":"bg-gray-50")})]})]})}):null,X?(0,r.jsxs)("ul",{role:"list",className:"flex flex-col pl-10",children:[V.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(SingleComment,{comment:e,mode:t,courseItemPracticeProblemEtcSlug:n,context:C,shouldShowCourseData:i})},e.uniqueId)),(0,r.jsx)("li",{hidden:!L,className:"-mt-3 text-sm",children:(0,r.jsx)("span",{className:(0,x.default)("cursor-pointer italic underline-offset-2 hover:underline",O?"text-gray-500 decoration-gray-500":"text-gray-700 decoration-gray-700"),onClick:()=>{er({variables:{offset:V.length,limit:10,context:C,courseItemPracticeProblemEtcSlug:n,parentCommentId:N}}).catch(e=>console.error(e))},children:"Load more"})})]}):null]}),eu=j.courseAndCourseItemInformation;if(!i||!eu)return ep;{let e=(0,u.C)({slug:eu.courseItemSlug,type:"section",title:eu.courseItemTitle,sectionName:eu.courseItemSection});return(0,r.jsxs)("div",{className:"grid grid-cols-3",children:[(0,r.jsx)("div",{className:"col-span-3 md:col-span-2",children:ep}),(0,r.jsx)("div",{className:"col-span-3 h-full w-full truncate md:col-span-1 md:pt-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(c.Z,{className:"aspect-[16/9] h-auto w-16 object-contain md:w-20",src:eu.courseThumbnailUrl,height:100,width:100,alt:eu.courseTitle}),(0,r.jsxs)("div",{className:"space-y-1 text-sm font-semibold leading-6",children:[(0,r.jsx)(s(),{href:"/".concat((0,w.fy)(eu.courseType),"/").concat(eu.courseSlug,"/").concat(e.section,"/").concat(e.niceSlug),target:"_blank",children:(0,r.jsx)("h3",{className:"hover:underline",children:eu.courseTitle})}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-600",children:eu.courseItemTitle})]})]})})]})}};t.Z=SingleComment},12152:function(e,t,i){"use strict";i.d(t,{Z:function(){return VoteButton}});var r=i(97458),n=i(66610),s=i(23474);function VoteButton(e){let{pressed:t,disabled:i,type:m,onClick:o}=e;return(0,r.jsx)(n.j9X,{className:"cursor-pointer rounded-full border border-transparent text-3xl hover:border hover:border-blue-600 ".concat(m===s.Fyp.Upvote?"-rotate-180":""," ").concat(i?"text-gray-500":t?"text-indigo-600":"text-black"),onClick:o})}},89823:function(e,t,i){"use strict";i.d(t,{Z:function(){return CommentSectionForUsers},t:function(){return ForumComments}});var r=i(97458),n=i(19639),s=i.n(n),m=i(28258),o=i(52983),a=i(26667),l=i(72688),d=i(23474),c=i(46942),p=i(59147),u=i(74223),h=i(61918),g=i(79068),x=i(58958),f=i(50894),v=i(11692),b=i(24600),y=i(42327),w=i(12152),j=i(51720),C=i(61489),N=i(14517),k=i(63079),I=i(41332),Comments_ForumAnswer=e=>{let{courseItemPracticeProblemEtcSlug:t,comment:i,context:n}=e,{uniqueId:m,authorUser:l,lastEditedByUserId:g,content:x,updatedAt:M,createdAt:S,upvotesCount:_,downvotesCount:E,loggedInUserAction:D,status:F}=i,T=F===d.rph.Deleted,A=(0,k.Z)(e=>e.deleteComment),P=(0,k.Z)(e=>e.addMoreCommentReplies),R=(0,k.Z)(e=>e.writeProperty),[Z,U]=(0,o.useState)(!1),q=(0,k.Z)(e=>e.storeMyVote),V=(0,k.Z)(e=>e._internalCommentSelfVoteMapping[m]),O=(0,k.Z)(e=>e.getCommentReplies({parentCommentUniqueId:m})),z=(0,p.Z)(),H=(0,j.ZP)(S),B=(0,j.ZP)(M),[L,W]=(0,o.useState)(),[K,Y]=(0,o.useState)(!1),[X,Q]=(0,o.useState)(!1),[G,J]=(0,o.useState)({editMode:!1,deleteMode:!1,content:x,edits:x,upvotesCount:_,downvotesCount:E}),[$,ee]=(0,o.useState)(""),[et,{loading:ei}]=(0,d.vMq)(),[er]=(0,d.sHn)(),[en,{loading:es}]=(0,d.urV)(),[em,{loading:eo}]=(0,d.soE)();(0,d.TtD)({skip:"yes"!==z,onCompleted(e){let{userData:t}=e;W(t)}});let closeEdit=()=>{J(e=>({...e,editMode:!1,deleteMode:!1})),Y(!1)},[ea]=(0,d.Cm1)({onCompleted:e=>{let{getForumItemComments:t}=e;P({parentCommentId:m,comments:t.comments}),t.remaining>0?U(!0):U(!1)}}),saveEdits=async()=>{Y(!0);let{data:e}=await en({variables:{commentId:m,content:G.edits}});(null==e?void 0:e.editComment.status)==="ok"?J((0,v.Z)(e=>{e.content=e.edits})):(0,h.A)((null==e?void 0:e.editComment.error)||"Failed to save your changes"),closeEdit()},createReply=async e=>{let{data:i}=await er({variables:{content:e,context:n,courseItemPracticeProblemEtcSlug:t,parentCommentId:m}});if((null==i?void 0:i.createComment.status)!=="ok")return(0,h.A)((null==i?void 0:i.createComment.error)||"Failed to add your reply."),"failed";{R({activelyReplyingCommentId:null});let e=i.createComment.data;return e&&P({parentCommentId:m,comments:[e],shouldAppendAtStarting:!0}),"success"}},deleteComment=async()=>{let e=await (0,I.S)({title:"Delete Comment",message:"Are you sure you want to delete this comment?",shouldRenderInDarkMode:!1});if("yes"!==e)return;let{data:i}=await em({variables:{commentId:m}});(null==i?void 0:i.deleteComment.status)==="ok"?"DELETED"===i.deleteComment.data&&A({courseItemPracticeProblemEtcSlug:t,commentId:m,context:n}):(0,h.A)((null==i?void 0:i.deleteComment.error)||"Failed to delete comment")},addVote=async e=>{if(ei)return;let t=null==L?void 0:L._id;if(!t){(0,u.ho)({isDismissable:!0});return}if(L.username===l.username){(0,h.a1)("You cannot ".concat(e.toLowerCase()," on your own comment!"));return}let{data:i}=await et({variables:{intent:e,commentId:m}});if(i&&i.addVote){let t=i.addVote;switch(t){case"404":(0,h.A)("Failed to ".concat(e));break;case"DOWNVOTE-UPVOTE":case"UPVOTE":q({commentId:m,voteType:d.M2R.Upvote});break;case"DOWNVOTE-DOWNVOTE":case"UPVOTE-UPVOTE":q({commentId:m,voteType:"removed"});break;case"DOWNVOTE":case"UPVOTE-DOWNVOTE":q({commentId:m,voteType:d.M2R.Downvote});break;default:(0,h.A)("Invalid vote state. Please contact support.")}}},el=L&&(0,y.H1)({creatorId:l.uniqueId,userId:L._id,email:L.email}),ed=_,ec=E;return"removed"===V?null==D||(D===d.M2R.Upvote?ed--:ec--):V===D||null!=V&&V!==D&&(null==D?V===d.M2R.Upvote?ed++:ec++:D===d.M2R.Upvote?(ed--,ec++):(ed++,ec--)),(0,r.jsx)("div",{id:m,children:(0,r.jsxs)("div",{className:"mt-6 flex",children:[(0,r.jsxs)("div",{className:"flex min-w-max flex-col items-center pr-2 pt-2 font-medium",children:[(0,r.jsx)(w.Z,{type:d.Fyp.Upvote,pressed:V===d.M2R.Upvote||null==V&&D===d.M2R.Upvote,disabled:ei,onClick:()=>{addVote(d.Fyp.Upvote).catch(e=>console.error(e))}}),(0,r.jsx)("span",{className:"text-xl ".concat(ec>ed?"-ml-2":""),children:ec>ed?"-".concat((0,u.pF)(Math.abs(ed-ec),0)):(0,u.pF)(Math.abs(ed-ec),0)}),(0,r.jsx)(w.Z,{type:d.Fyp.Downvote,pressed:V===d.M2R.Downvote||null==V&&D===d.M2R.Downvote,disabled:ei,onClick:()=>{addVote(d.Fyp.Downvote).catch(e=>console.error(e))}})]}),(0,r.jsxs)("div",{className:"flex grow flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:(0,N.default)("rounded bg-white px-4 pb-3 pt-4 shadow",T?"opacity-40":""),children:[G.editMode?(0,r.jsx)("div",{className:"prose !max-w-none overflow-hidden !text-black",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"block",children:(0,r.jsx)(c.default,{maxHeight:"220px",placeholder:"It is recommended that you don't change the context entirely",value:G.edits,onChange:e=>J((0,v.Z)(t=>{t.edits=e}))})}),(0,r.jsxs)("div",{className:"-mt-6 flex items-center gap-2 px-2 pb-2",children:[(0,r.jsx)("button",{type:"button",className:"inline-flex items-center rounded border border-gray-300 bg-white px-2.5 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:()=>{closeEdit(),J(e=>({...e,edits:G.content}))},children:"Cancel"}),(0,r.jsx)("button",{type:"button",disabled:es,className:"inline-flex items-center rounded border border-transparent bg-indigo-600 px-2.5 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:text-gray-500 disabled:opacity-40 disabled:ring-0 disabled:hover:font-normal",onClick:()=>{saveEdits().catch(e=>console.error(e))},children:"Save Changes"})]})]})}):G.deleteMode?(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(a.VPh,{className:"h-5 w-5 text-red-800","aria-hidden":"true"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Delete Answer?"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,r.jsx)("p",{children:"Are you sure? This answer will be marked as deleted and its content will be permanently removed from the forum"})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("div",{className:"-mx-2 -my-1.5 flex gap-2",children:[(0,r.jsx)("button",{type:"button",className:"inline-flex items-center rounded border border-transparent bg-red-200 px-2.5 py-1.5 text-xs font-medium text-red-800 shadow-sm hover:bg-red-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",onClick:()=>{closeEdit()},children:"Cancel"}),(0,r.jsx)("button",{type:"button",disabled:eo,className:"inline-flex items-center rounded border border-transparent bg-red-600 px-2.5 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:text-gray-500 disabled:opacity-40 disabled:ring-0 disabled:hover:font-normal",onClick:()=>{deleteComment().catch(e=>console.error(e))},children:"Delete"})]})})]})]})})}):(0,r.jsx)("div",{className:(0,N.default)("!max-w-none overflow-hidden",T&&"italic"),children:(0,r.jsx)(C.Z,{markdown:G.content})}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-2",children:[(0,r.jsx)("button",{disabled:T||K,onClick:()=>{J(e=>({...e,editMode:!1,deleteMode:!0})),Y(!0)},className:"".concat(el?"":"hidden"," rounded bg-gray-100 p-1 hover:bg-red-200 hover:text-red-700 disabled:bg-gray-500 disabled:text-black disabled:opacity-0 disabled:ring-0 disabled:hover:bg-gray-500"),children:(0,r.jsx)(a.VPh,{})}),(0,r.jsx)("button",{disabled:T||K,onClick:()=>{J(e=>({...e,editMode:!0})),Y(!0)},className:"".concat(el?"":"hidden"," rounded bg-gray-100 p-1 hover:bg-indigo-200 hover:text-indigo-700 disabled:bg-gray-500 disabled:text-black disabled:opacity-0 disabled:ring-0 disabled:hover:bg-gray-500"),children:(0,r.jsx)(a.$iz,{})}),(0,r.jsx)("div",{className:"".concat(el?"hidden":""," h-6 bg-white")})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-end border-t bg-gray-100/80 px-4 py-4 text-sm",children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("time",{dateTime:H.toString(),className:"mb-1.5 text-xs font-medium text-gray-800 group-hover:text-gray-700",children:["Answered"," ","string"==typeof g?H.format("MMMM D, YY"):H.fromNow()]}),(0,r.jsx)(s(),{href:"/user/".concat(l.username),className:"group block flex-shrink-0",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"h-10 w-10 overflow-hidden rounded-full bg-gray-200 ring-1 ring-gray-200 ring-offset-1",children:(0,r.jsx)(b.Z,{src:l.profilePicUrl||"/assets/images/avatar.png",height:40,width:40,className:"object-cover",alt:"@"+l.username})}),(0,r.jsxs)("div",{className:"ml-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-indigo-700 group-hover:text-indigo-900",children:l.name}),(0,r.jsxs)("p",{className:"text-xs font-medium text-gray-600 group-hover:text-gray-700",children:["@",l.username]})]})]})}),"string"==typeof g&&(0,r.jsxs)("time",{dateTime:B.toString(),className:"mt-1.5 text-xs font-medium text-gray-500 group-hover:text-gray-700",children:["Edited ",B.fromNow()]})]})}),(0,r.jsx)(f.u,{show:X,enter:"transition duration-150 ease-out",enterFrom:"transform scale-95 opacity-50",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-50",className:"z-0 mt-2",children:(0,r.jsxs)("div",{className:"overflow-hidden rounded border shadow",children:[(0,r.jsx)(c.default,{hideToolbar:!0,maxHeight:"180px",disallowHeadings:!0,placeholder:"Commenting on ".concat(l.username,"'s answer"),value:$,onChange:e=>ee(e)}),(0,r.jsxs)("div",{className:"-mt-8 flex gap-2 p-2",children:[(0,r.jsx)("button",{type:"button",className:"inline-flex items-center rounded border border-gray-300 bg-white px-2.5 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:()=>{Q(!1),Y(!1)},children:"Cancel"}),(0,r.jsx)("button",{type:"button",className:"inline-flex items-center rounded border border-transparent bg-indigo-600 px-2.5 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:()=>{createReply(x).catch(e=>console.error(e))},children:"Post Comment"})]})]})}),!X&&(0,r.jsx)("div",{className:"flex w-full items-center",children:(0,r.jsx)("button",{className:"cursor-pointer px-2 text-sm text-indigo-400 hover:font-medium hover:text-indigo-600 disabled:text-gray-500 disabled:opacity-40 disabled:ring-0 disabled:hover:font-normal ".concat(Z?"":"hidden"),onClick:()=>{ea({variables:{offset:O.length,limit:10,context:n,courseItemPracticeProblemEtcSlug:t,parentCommentId:m}}).catch(e=>console.error(e))},children:"View more comments"})})]})]})})},M=i(45087),S=i(36177);let ForumComments=e=>{var t;let{forumItem:i,type:n,closed:g,totalComments:x}=e,f=(0,p.Z)(),v=(0,m.useRouter)(),[b,y]=(0,o.useState)(""),[w,j]=(0,o.useState)(!1),[C,N]=(0,o.useState)(x<15),k=(0,M.Z)(),[I,S]=(0,o.useState)(null!==(t=i.comments)&&void 0!==t?t:[]),[_,E]=(0,o.useState)(""),[D]=(0,d.sHn)(),[F]=(0,d.Cm1)({fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:e=>{let{getForumItemComments:t}=e;if(t.error){"unpublished"===t.error?E("Commenting is disabled on unpublished course/items."):E("Failed to load comment section. Please contact support.");return}S(e=>[...e,...t.comments]),t.remaining>0?N(!1):N(!0)}}),submitAnswer=async()=>{if(j(!0),"yes"!==f||!k){j(!1),(0,u.ho)({isDismissable:!0});return}let{data:e}=await D({variables:{courseItemPracticeProblemEtcSlug:i.associatedSlug||"",context:i.context,content:b,parentCommentId:null}}),t=null==e?void 0:e.createComment.data;t&&"ok"===e.createComment.status?(S(e=>[...e,t]),y(""),setTimeout(()=>{v.push("#".concat(t.uniqueId),void 0,{shallow:!0})},200)):(0,h.A)((null==e?void 0:e.createComment.error)||"Failed to add your answer."),j(!1)};return(0,r.jsxs)("section",{children:[(0,r.jsxs)("div",{className:"mt-6 w-full",children:[n===d.rwX.Question?(0,r.jsx)("h2",{id:"answers-count",className:"text-lg font-medium text-gray-900",children:"".concat(x," ").concat(1===x?"Answer":"Answers")}):(0,r.jsx)("h2",{id:"answers-count",className:"text-lg font-medium text-gray-900",children:"".concat(x," ").concat(1===x?"Comment":"Comments")}),I.length>0?(0,r.jsxs)("div",{children:[(0,r.jsx)("ul",{className:"space-y-8 divide-y divide-gray-300 border-t border-gray-300",children:I.map((e,t)=>(0,r.jsx)(Comments_ForumAnswer,{context:d.uSl.Forum,courseItemPracticeProblemEtcSlug:i.slug,mode:"light",shouldShowCourseData:!1,comment:e},e.uniqueId+"-"+t.toString()))}),(0,r.jsx)("div",{className:C?"hidden":"flex items-center justify-center",children:(0,r.jsx)("span",{className:"mt-4 cursor-pointer text-center font-light italic tracking-wider text-indigo-600 underline decoration-indigo-600 underline-offset-2",onClick:()=>{F({variables:{offset:I.length,limit:15,courseItemPracticeProblemEtcSlug:i.associatedSlug,parentCommentId:null,context:d.uSl.Forum}}).catch(e=>console.error(e))},children:"show more answers"})})]}):(0,r.jsxs)("div",{className:"relative mt-4 block w-full rounded border-2 border-dashed border-gray-400 p-12 pb-10 text-center focus:outline-none",children:[g?(0,r.jsx)(a.cq1,{className:"mx-auto text-7xl text-gray-500"}):(0,r.jsx)(a.RG4,{className:"mx-auto text-7xl text-gray-500"}),g?(0,r.jsxs)("span",{className:"mb-6 mt-2 block text-sm font-medium text-gray-600",children:["This ",n," was closed by the author."]}):n===d.rwX.Question?(0,r.jsxs)("span",{className:"mb-6 mt-2 block text-sm font-medium text-gray-600",children:["This is an unanswered question."," ","yes"===f?"Be the first to answer it!":"Create an account to answer it!"]}):(0,r.jsxs)("span",{className:"mb-6 mt-2 block text-sm font-medium text-gray-600",children:["This comment section is empty."," ","yes"===f?"Be the first to comment!":"Create an account to post your comment!"]}),"yes"!==f&&(0,r.jsx)(s(),{href:"/register",className:"inline-flex items-center rounded-md bg-gradient-to-r from-indigo-500 to-cyan-600 px-4 py-1.5 text-center text-base font-medium text-white hover:bg-gradient-to-l lg:mx-4",children:"Create Free Account"})]})]}),g?null:_?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"max-w-xl rounded-md border border-yellow-800 bg-yellow-900/20 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(l.SgR,{className:"h-5 w-5 text-yellow-400","aria-hidden":"true"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-400",children:"Comments disabled"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-white",children:(0,r.jsx)("p",{children:_})})]})]})})}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"relative mb-2 mt-8",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:(0,r.jsx)("div",{className:"w-full border-t border-gray-400"})}),(0,r.jsx)("div",{className:"relative flex",children:(0,r.jsx)("span",{className:"bg-gray-50 pr-2 text-gray-700",children:n===d.rwX.Question?"Your answer":"Your comment"})})]}),(0,r.jsx)(c.default,{placeholder:"Explain your content in detail here [markdown supported]",value:b,onChange:e=>y(e)}),(0,r.jsx)("button",{type:"button",disabled:w,onClick:()=>{submitAnswer().catch(e=>console.error(e))},className:"-mt-2 inline-flex w-fit items-center rounded border border-transparent bg-indigo-600 px-4 py-1.5 text-sm font-medium text-white shadow hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:bg-gray-500 disabled:text-black disabled:opacity-40 disabled:ring-0 disabled:hover:bg-gray-500",children:n===d.rwX.Question?"Post Answer":"Post Comment"})]})]})},CommentSectionForUsers=e=>{var t,i;let{courseItemPracticeProblemEtcSlug:n,context:s,mode:m,className:a,markdownEditor:f,shouldReverseCommentInputAndCommentsOrder:v}=e,b=(0,k.Z)(e=>e.getComments({courseItemPracticeProblemEtcSlug:n,context:s})),y=(0,k.Z)(e=>e.addMoreComments),[w,j]=(0,o.useState)(""),[C,I]=(0,o.useState)(""),M=(0,p.Z)(),[_,{loading:E}]=(0,d.sHn)(),{refetch:D,loading:F}=(0,d.ONb)({skip:!n||b&&b.comments.length>0,fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0,variables:{offset:0,limit:15,courseItemPracticeProblemEtcSlug:n,context:s},onCompleted:e=>{let{getForumItemComments:t}=e;if(y({courseItemPracticeProblemEtcSlug:n,comments:t.comments,context:s,remainingCommentsCount:t.remaining}),null===t.forumItemID&&t.error){"unpublished"===t.error?I("Commenting is disabled on unpublished course/items."):I("Failed to load comment section. Please contact support.");return}}}),T=null!==(t=null==b?void 0:b.remainingCommentsCount)&&void 0!==t?t:0,A=b?b.comments.length:0,P=T<=0,R=T+A,Z=(0,o.useRef)(null),addNewComment=async e=>{if(!e||0===e.trim().length)return(0,h.A)("Please type your comment before posting."),"failed";if("no"===M)return(0,u.ho)({isDismissable:!0,isDarkMode:!0}),"failed";let{data:t}=await _({variables:{courseItemPracticeProblemEtcSlug:n,content:e,context:s,parentCommentId:null}}),i=null==t?void 0:t.createComment.data;return(Z.current&&(Z.current.scrollTop=0),(null==t?void 0:t.createComment.status)==="ok"&&i)?(y({courseItemPracticeProblemEtcSlug:n,comments:[i],context:s,remainingCommentsCount:T,shouldAppendAtStarting:!0}),j(""),"success"):((0,h.A)((null==t?void 0:t.createComment.error)||"Failed to add your comment."),"failed")};return(0,r.jsx)("div",{className:(0,N.default)(a,"flex h-full px-4",v?"flex-col-reverse":"flex-col"),children:C?(0,r.jsx)("div",{className:"max-w-xl rounded-md border border-yellow-800 bg-yellow-900/20 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(l.SgR,{className:"h-5 w-5 text-yellow-400","aria-hidden":"true"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-yellow-400",children:"Discussion disabled"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-white",children:(0,r.jsx)("p",{children:C})})]})]})}):(0,r.jsxs)(r.Fragment,{children:[f?(0,r.jsxs)("div",{className:"flex flex-col gap-2 mt-4",children:[(0,r.jsx)(c.default,{placeholder:"Add your comment... [markdown supported]",value:w,maxHeight:"150px",onChange:e=>j(e),mode:m}),(0,r.jsx)(S.z,{type:"button",className:"ml-auto w-fit",disabled:E,onClick:()=>{addNewComment(w).catch(e=>console.error(e))},children:"Post comment"})]}):(0,r.jsx)(g.Z,{type:"comment",mode:m,networkBusy:E,onSubmit:addNewComment,onCancel:null}),(0,r.jsxs)("div",{ref:Z,className:(0,N.default)("flex flex-grow flex-col overflow-y-auto"),children:[(0,r.jsx)("div",{className:"py-4",children:(0,r.jsx)("h2",{className:"flex items-center text-xl font-bold",children:(0,r.jsxs)("span",{className:"mr-2.5",children:[0===R?"No":R," comment",1===R?"":"s"," ",0===R?"so far":""]})})}),(null!==(i=null==b?void 0:b.comments)&&void 0!==i?i:[]).map((e,t)=>(0,r.jsx)("div",{children:(0,r.jsx)(x.Z,{shouldShowCourseData:!1,comment:e,mode:m,context:s,courseItemPracticeProblemEtcSlug:n})},e.uniqueId+t.toString())),P?null:(0,r.jsx)("div",{className:"my-4",children:(0,r.jsx)(S.z,{disabled:F,size:"small",onClick:()=>{D({offset:A,limit:5,courseItemPracticeProblemEtcSlug:n,parentCommentId:null,context:s}).catch(e=>console.error(e))},children:"View older comments"})})]})]})})}},42327:function(e,t,i){"use strict";i.d(t,{H1:function(){return isForumActionPermitted},c1:function(){return r},fm:function(){return capitalizeFirstLetter},qo:function(){return n}}),i(23474),i(81678),i(19629);let r=20,n=10;function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}let isForumActionPermitted=e=>{let{creatorId:t,userId:i,email:r}=e;return t===i||!!(r&&r.endsWith("@codedamn.com"))}},61489:function(e,t,i){"use strict";var r=i(97458),n=i(14517),s=i(52983),m=i(75193),o=i(61816);i(3432);var a=i(54387);let l=["apacheconf","basic","c","diff","java","javascript","jsx","kotlin","python","solidity","sql","typescript","yaml"];t.Z=e=>{let{markdown:t,proseClassNames:d,languages:c=l,disallowHeadings:p}=e,u=(0,s.useId)();return(0,s.useEffect)(()=>{let loadStyles=async()=>{for await(let e of c)await i(32130)("./prism-".concat(e,".min"))};loadStyles().then(()=>{let e=document.getElementById(u);e&&o.Z.highlightAllUnder(e)}).catch(console.error)},[c,u]),(0,r.jsx)("div",{id:u,className:(0,n.default)("prose dark:prose-invert prose-pre:!bg-[#2d2d2d] h-full w-full !max-w-none overflow-hidden [font-size:inherit]",d),children:(0,r.jsx)(m.D,{remarkPlugins:[a.Z],components:{code(e){let{className:t,children:i,...n}=e,s=/language-(\w+)/.exec(t||"");return s?(0,r.jsx)("code",{...n,className:t,children:i}):(0,r.jsx)("code",{...n,className:"language-html "+(t||""),children:i})},...p?{h1:"p",h2:"p",h3:"p",h4:"p"}:{}},children:t})})}},46942:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return components_MarkdownEditor}});var r=i(97458),n=i(53067),s=i(55693),m=i.n(s),o=i(52983),a=i(66371),l=i(75193),d=i(54387),c=i(23474),p=i(69335),u=i(19629),h=i(61918),hooks_useUpload=e=>{let{purePreSignedUrlGetter:t,disabled:i}=e,[r,n]=(0,o.useState)(!1),s=(0,o.useRef)(t),m=(0,o.useCallback)(async e=>{if(i)return(0,h.A)("Image uploads are disabled"),null;n(!0);try{var t,r;let i=e.name.split("."),n=(null===(r=i[i.length-2])||void 0===r?void 0:null===(t=r.split("/"))||void 0===t?void 0:t.pop())||Date.now().toString(),m=i.pop();(0,u.k)(m,"No file extension?");let o=await s.current(n,m);(0,u.k)(o,"Failed to get preSignedUrl!");let a=await fetch(o,{method:"PUT",body:e,headers:{"Content-Type":p.lookup(m)||"text/plain"}});if(200===a.status)return o.split("?")[0];return(0,h.A)("Something went wrong with your upload. Try again"),null}catch(e){return null}finally{n(!1)}},[i]),a=(0,o.useMemo)(()=>({uploadFile:m,uploading:r}),[m,r]);return a},g=i(61816);i(3432),i(59954);var x=i(14517);let f=m()(()=>Promise.all([i.e(81204),i.e(6297),i.e(79881)]).then(i.bind(i,6297)),{loadableGenerated:{webpack:()=>[6297]},ssr:!1,loading:()=>(0,r.jsx)("div",{className:"mb-4 w-full rounded-md border border-gray-100 dark:border-gray-800",children:(0,r.jsxs)("div",{className:"flex animate-pulse flex-col gap-2",children:[(0,r.jsx)("div",{className:"flex-1 space-y-6",children:(0,r.jsx)("div",{className:"h-10 rounded bg-gray-100 dark:bg-gray-900"})}),(0,r.jsx)("div",{className:"aspect-5 h-auto w-full rounded bg-gray-100 dark:bg-gray-900"})]})})});var components_MarkdownEditor=e=>{let t=(0,o.useId)(),s=(0,n.x)();(0,o.useEffect)(()=>{(async function(){for await(let e of["jsx","apacheconf","c","diff","java","javascript","kotlin","python","solidity","typescript","yaml"])await i(32130)("./prism-".concat(e,".min"))})().catch(console.error)},[]);let{uploadFile:m}=hooks_useUpload({disabled:!0!==e.uploadImage,purePreSignedUrlGetter:async(e,t)=>{let{data:{getPreSignedURLForUploadingInstructorFile:i}}=await s.query({query:c.Vt4,variables:{fileExt:t,context:c.rXY.Markdown}}),{status:r,data:n,error:m}=i;return m||"ok"!==r||!n?((0,h.A)("Failed to upload!"),null):n}}),p=(0,o.useMemo)(()=>{let t={spellChecker:!1,sideBySideFullscreen:!1,placeholder:e.placeholder||"",hideIcons:["preview"],showIcons:["side-by-side"],imageUploadFunction(e,t,i){m(e).then(e=>e?t(e):i("Failed to upload file")).catch(e=>{i((null==e?void 0:e.message)||"Something went wrong")})},previewRender:t=>a.renderToString((0,r.jsx)("div",{className:(0,x.default)("prose !max-w-none","dark"===e.mode&&"prose-invert"),children:(0,r.jsx)(l.D,{remarkPlugins:[d.Z],components:{code(e){let{className:t,children:i,...n}=e,s=/language-(\w+)/.exec(t||"");return s?(0,r.jsx)("code",{...n,className:t,children:i}):(0,r.jsx)("code",{...n,className:"language-html "+(t||""),children:i})},...e.disallowHeadings?{h1:"p",h2:"p",h3:"p",h4:"p"}:{}},children:t})}))};return e.hideToolbar&&(t.toolbar=!1),e.maxHeight&&(t.maxHeight=e.maxHeight),e.uploadImage&&(t.uploadImage=!0),t},[e.mode,e.disallowHeadings,e.hideToolbar,e.maxHeight,e.placeholder,e.uploadImage,m]);return(0,r.jsx)("div",{className:(0,x.default)("[&_div.editor-preview_pre]:!my-[0.5em] [&_div.editor-preview_pre]:!whitespace-pre [&_div.editor-preview_pre]:!bg-[#2d2d2d] [&_div.editor-preview_pre]:!p-[1em] [&_div.editor-preview_pre]:!text-[1em] [&_div.editor-preview_pre]:!leading-snug","[&_div.editor-preview_code]:!bg-[#2d2d2d] [&_div.editor-preview_code]:!px-[0.25rem] [&_div.editor-preview_code]:!py-[0.1rem] [&_div.editor-preview_code]:!font-semibold",e.focusEnabled&&"rounded-md focus-within:ring-2 focus-within:ring-indigo-600","dark"===e.mode&&"dark"),id:t,children:(0,r.jsx)(f,{className:"dark:[&_div.CodeMirror-cursor]:border-l dark:[&_div.CodeMirror-cursor]:border-white dark:[&_div.CodeMirror-selected]:!bg-gray-600/30 dark:[&_div.EasyMDEContainer_div.CodeMirror-wrap]:!bg-gray-900 dark:[&_div.EasyMDEContainer_div.CodeMirror-wrap]:!text-white dark:[&_div.EasyMDEContainer_div.CodeMirror-wrap]:![caret-color:white] [&_div.EasyMDEContainer_div.CodeMirror-wrap_div.CodeMirror-vscrollbar]:!hidden dark:[&_div.EasyMDEContainer_div.CodeMirror]:!border-gray-600 dark:[&_div.EasyMDEContainer_div.editor-preview-side]:!border-gray-600 dark:[&_div.EasyMDEContainer_div.editor-preview-side]:!bg-gray-900 [&_div.EasyMDEContainer_div.editor-toolbar_button.active]:!bg-transparent hover:[&_div.EasyMDEContainer_div.editor-toolbar_button]:!bg-transparent active:[&_div.EasyMDEContainer_div.editor-toolbar_button]:!bg-transparent dark:[&_div.EasyMDEContainer_div.editor-toolbar_i]:!border-gray-600 dark:[&_div.editor-toolbar.fullscreen]:!bg-gray-900 dark:[&_div.editor-toolbar]:!border-gray-600",value:e.value,options:p,onChange:i=>{let r=document.getElementById(t);r&&setTimeout(()=>{g.Z.highlightAllUnder(r)},0),e.onChange(i)}})})}},63079:function(e,t,i){"use strict";i(42985);var r=i(82780);i(79432);var n=i(66532);let getStoreKeyForForumItemComments=e=>"".concat(e.courseItemPracticeProblemEtcSlug,"//").concat(e.context),getStoreKeyForCommentReplies=e=>"".concat(e.commentUniqueId),s=(0,r.Ue)((e,t)=>({activelyReplyingCommentId:null,_internalCommentSelfVoteMapping:{},_internalCommentReplyMapping:{},_internalCommentsMapping:{},writeProperty:t=>{"function"==typeof t?e(e=>t(e)):e(t)},storeMyVote(t){e((0,n.ZP)(e=>{e._internalCommentSelfVoteMapping[t.commentId]=t.voteType}))},getComments:e=>t()._internalCommentsMapping[getStoreKeyForForumItemComments(e)],deleteComment(t){e((0,n.ZP)(e=>{let i=e._internalCommentsMapping[getStoreKeyForForumItemComments(t)];if(i){let e=i.comments.findIndex(e=>e.uniqueId===t.commentId);e>=0&&i.comments.splice(e,1)}}))},addMoreComments(t){e((0,n.ZP)(e=>{let i=e._internalCommentsMapping[getStoreKeyForForumItemComments(t)];if(i){let e=i.comments;i.comments=(t.shouldAppendAtStarting?[...t.comments,...e]:[...e,...t.comments]).filter((e,t,i)=>i.findIndex(t=>t.uniqueId===e.uniqueId)===t),i.remainingCommentsCount=t.remainingCommentsCount}else e._internalCommentsMapping[getStoreKeyForForumItemComments(t)]=t}))},addMoreCommentReplies(t){e((0,n.ZP)(e=>{let i=getStoreKeyForCommentReplies({commentUniqueId:t.parentCommentId}),r=e._internalCommentReplyMapping[i];null!=r?e._internalCommentReplyMapping[i]=(t.shouldAppendAtStarting?[...t.comments,...r]:[...r,...t.comments]).filter((e,t,i)=>i.findIndex(t=>t.uniqueId===e.uniqueId)===t):e._internalCommentReplyMapping[i]=t.comments}))},getCommentReplies(e){var i;return null!==(i=t()._internalCommentReplyMapping[getStoreKeyForCommentReplies({commentUniqueId:e.parentCommentUniqueId})])&&void 0!==i?i:[]}}));t.Z=s},45087:function(e,t,i){"use strict";var r=i(99689),n=i(52983),s=i(80834),m=i(79432),o=i(85797),a=i(57861).lW;let l=s.z.object({name:s.z.string(),username:s.z.string(),_id:s.z.string(),exp:s.z.number().nullish()}),getUserDataFromAuthJwt=e=>{try{let t;let i=(null==e?void 0:e.forceAuthToken)||(0,m.gc)(null==e?void 0:e.ctx);if(!i)return null;if("Buffer"in globalThis){let e=i.split(".")[1];t=JSON.parse(a.from(e,"base64").toString())}else t=r.ZP.decode(i).payload;let n=l.parse(t);if(n.exp&&n.exp<Date.now()/1e3)throw Error("Expired token");return n}catch(e){return null}};t.Z=()=>{let e=(0,o._)(m.Tt),t=(0,n.useMemo)(()=>(null==e?void 0:e.value)?getUserDataFromAuthJwt({forceAuthToken:e.value}):null,[e]);return t}},61816:function(e,t,i){"use strict";var r=i(89652),n=i.n(r);n().manual=!0,t.Z=n()},3432:function(){}}]);